\section{Results}
\label{ref_results}

The results from the the two literature reviews and the development of the anomaly detector are utilized here. The anomaly detector was created in Python with the STUMPY library implementation of the Iterative Matrix Profile detector. In this section, the datasets from Section \ref{ref_datasets} are tested using the developed matrix profile anomaly detection technique against different properties and anomaly types. The parameters for each trail are listed and the results are explain. Further analysis is performed in Section \ref{sec:discussion}.

\subsection{Hydraulic Simulation Dataset}
\label{ref_results_hydraulic_sim}
The hydraulic simulation dataset presented in Section \ref{ref_hydraulic_dataset} is used to perform this simulation. Table \ref{tab:hydraulic_sim_params} specifies the parameters used with the anomaly detector to obtain the results in this section. This is the smallest dataset tested in this study and it outlines the performance and characteristics of the anomaly detector at small window sizes. The standard deviation multiplier is the default for the detector. If the data follows a standard Gaussian distribution, the detected points would fall outside 99.7\% of the data present in the window, which would represent a significant outlier comparative to the rest of the data. The same principal applies to the rolling range multiplier. The recent range detection debounce multiplier is also standard given the small window size and ensures that there are not over-noisy or duplicate detections.

This experiment demonstrate that the developed detector is robust to changes in scale. Figure \ref{fig:hydraulic_result_fp} shows that the pressure and force signals in the system have similar shape but different magnitude. 

\begin{equation}
    \label{eqn:cylinder_force}
    F = (A_1 \cdot p_A) - \dot{x}  | A_1 \cdot p_A | (1 - \eta)
\end{equation}

This relationship in the shape of the pressure and force signals is derived from the force pressure relationship described in Equation \ref{eqn:cylinder_force}. As the pressure increases, the force exerted by the hydraulic cylinder increase proportionally. Since the boom arm and end effector in the system are fixed, the end effector moves proportionally to the change in force. Figure \ref{fig:hydraulic_result_fp} shows small differences between the force and pressure which is a result of the modeling of the hydraulic boom arm as a flexible body, which introduces additional oscillation which affects the pressure.

\begin{table}[H]
%%\centering
\caption{Hydraulic Simulation Detector Parameters}
\begin{tabular}{|l|c|l|}
    \hline
	\textbf{Parameter} & \textbf{Value} & \textbf{Description} \\ \hline
	m & 15 & Window Size \\ \hline
	ts$\_$size & 30 & Time Series Size \\ \hline
	std$\_$dev & 3 & Standard Deviation Multiplier \\ \hline
	range & 3 & Rolling Range Multiplier\\ \hline
	recent & 2 & Recent Detection Debounce\\ \hline
\end{tabular}
\label{tab:hydraulic_sim_params}
\end{table}

Figure \ref{fig:hydraulic_result_fp} shows the force and pressure with the anomaly detections from the experiment highlighted with red lines. In this case, the detection points represent motif changes in the signals. The detector was able to locate all of these inflection points without false positives. This is a 100\% accuracy rate for the detector. The amplitude and waveform of the signals presented here are identical to the force signal presented above. The primary difference is the different amplitudes. The pressure signal is two orders of magnitude larger in amplitude, which illustrates the detector is robust to scale variations.

\begin{figure}[H]
    %\centering
    \input{1_hydraulic_sim/results/outlier_result_scale_variant_detection.pgf}
    \caption{Hydraulic Crane Results [Red Line = Motif Change]}
    \label{fig:hydraulic_result_fp}
\end{figure}

Figure \ref{fig:hydraulic_mp_hist_fp} shows the values calculated during the matrix profile for the force and pressure of the system with the control signal in Figure \ref{fig:hydraulic_cs}. The shape of the matrix profile value signals is nearly identical for the force and pressure values. The two signals have dramatically different magintudes but similar shapes. This shows the algorithm is robust to different macro data scales and explains the results obtained in Figure \ref{fig:hydraulic_result_fp}.
\begin{figure}[H]
    %\centering
    \input{1_hydraulic_sim/results/mp_hist_scale_variant_pressure_force.pgf}
    \caption{Hydraulic Simulation Matrix Profile Values}
    \label{fig:hydraulic_mp_hist_fp}
\end{figure}


\subsection{Power Electronic Converter Dataset}
\label{ref_results_pec_sim}
The Power Electronic Converter (PEC) dataset presented in Section \ref{ref_pec_dataset} is used to perform this simulation. Table \ref{tab:pec_sim_params} specifies the parameters used with the anomaly detector to obtain the results in this section. This dataset is significantly larger than the previous, containing approximately 300,000 time steps (~83 hour of signal data). This dataset outlines the scenarios at which this detector excels and its performance for medium window sizes. The standard deviation multiplier is significant. If the data follows a standard Gaussian distribution, the detected points would fall outside 99.999\% of the data present in the window, which would represent a significant outlier comparative to the rest of the data. The rolling range multiplier is disabled for this experiment since the outliers are not relational to each other. There are 4 different types of outliers which all have radically different behaviors and signal shapes, so it is not desired to compare or remember them in the context of the next outlier. The recent range detection debounce multiplier is only one due to the larger size of the time series window and overall window size.

\begin{table}[H]
%%\centering
\caption{PEC Dataset Detector Parameters}
\begin{tabular}{|l|c|l|}
    \hline
	\textbf{Parameter} & \textbf{Value} & \textbf{Description} \\ \hline
	m & 250 & Window Size \\ \hline
	ts$\_$size & 5000 & Time Series Size \\ \hline
	std$\_$dev & 4 & Standard Deviation Multiplier \\ \hline
	range & 0 & Rolling Range Multiplier\\ \hline
	recent & 1 & Recent Detection Debounce\\ \hline
\end{tabular}
\label{tab:pec_sim_params}
\end{table}

Figure \ref{fig:pec_mp_hist} shows the computed matrix profile values during the experiment. Because of the scale variance of the anomalies, only 2 of the 4 detected anomalies are visually represented in the figure. The 2 anomalies that are not depicted show similar patterns, but at much smaller scale. This shows the detector is able to perform on signals with widely differing anomaly characteristics and patterns.

\begin{figure}[H]
    %%\centering
    \input{2_pec_sim/mp_hist_f_c.pgf}
    \caption{PEC Dataset Matrix Profile Values}
    \label{fig:pec_mp_hist}
\end{figure}

Figure \ref{fig:pec_outliers} shows the anomalies detected by the algorithm in red, over the manually labeled anomaly (true/false values) start and end periods. The detector accurately determined the start and end of each anomaly (100\% detection rate) with no false positives (0\% error rate). It detected the start of each anomaly almost immediately quickly detected the end of the corresponding anomaly once it was over, although this takes more time in certain cases. By nature, anomalies are rare so interpreting the detection and false positive rates in a traditional way is not possible. The interpretation of the results and significance are provided in Section \ref{sec:discussion}.
 
\begin{figure}[H]
    %%\centering
    \input{2_pec_sim/outlier_result_f_c.pgf}
    \caption{PEC Dataset Anomalies [Red Line = Anomaly]}
    \label{fig:pec_outliers}
\end{figure}

\subsection{Cyber Security BETH Dataset}
\label{ref_results_beth_sim}
The Cyber Security BETH dataset presented in Section \ref{ref_beth_dataset} is used to perform this simulation. Table \ref{tab:beth_sim_params} specifies the parameters used with the anomaly detector to obtain the results in this section. This dataset is the largest of all in this study, containing approximately 800,000 time steps (~9 days of signal data). This dataset outlines the most challenging of the test scenarios for the detector and its performance for large window sizes. The standard deviation multiplier is the default. If the data follows a standard Gaussian distribution, the detected points would fall outside 99.7\% of the data present in the window, which would represent a significant outlier comparative to the rest of the data. The rolling range multiplier is set to one below the standard deviation multiplier for this experiment which provides some recall of previous outliers, but provides more weight to the present outlier detection score. The attacks have been manually labelled and although there are different kinds of attacks, the baseline signal (userId) remains the same. The recent range detection debounce multiplier is two due to the nature and volatility of the data.

\begin{table}[H]
%%\centering
\caption{BETH Dataset Model Parameters}
\begin{tabular}{|l|c|l|}
    \hline
	\textbf{Parameter} & \textbf{Value} & \textbf{Description} \\ \hline
	m & 1000 & Window Size \\ \hline
	ts$\_$size & 10,000 & Time Series Size \\ \hline
	std$\_$dev & 3 & Standard Deviation Multiplier \\ \hline
	range & 2 & Rolling Range Multiplier\\ \hline
	recent & 2 & Recent Detection Debounce\\ \hline
\end{tabular}
\label{tab:beth_sim_params}
\end{table}

Figure \ref{fig:beth_mp_hist} shows the computed matrix profile values for this experiment. In this study, the outliers are only present when there is a significantly large range spike as shown near time step 200,000. The regular and periodic small peaks prior are not outliers and the rolling range technique ensures they do not trigger the detector. This provides an example of how the rolling range parameter can be used to tune the memory and ability of the detector. 

\begin{figure}[H]
    %%\centering
    \input{3_beth_sim/mp_hist_userId.pgf}
    \caption{BETH Matrix Profile}
    \label{fig:beth_mp_hist}
\end{figure}

Figure \ref{fig:beth_sus_outliers} shows the algorithms detection results compared to the values considered suspicious by Authors \cite{beth-dataset} of the BETH dataset. They determined that many of the data points that are considered suspicious are not actually dangerous (evil in their taxonomy) as shown in Figure \ref{fig:beth_evil_outliers}. In this case, the detector is able to discern where the dangerous outliers lie among the very noisy suspicious data points. This is the most challenging dataset analyzed thus far and as such the results do not provide 100\% accuracy with no false positives.

% TODO: Redo axis labels
 \begin{figure}[H]
    %%\centering
    \input{3_beth_sim/outlier_result_sus_userId.pgf}
    \caption{BETH Suspicious Outliers [Red Line = Anomaly]}
    \label{fig:beth_sus_outliers}
\end{figure}

Figure \ref{fig:beth_evil_outliers} shows the algorithms detection results compared to the values considered evil by the creators of the BETH dataset. The algorithm was able to detect the starts of the outliers within the debounce threshold and was able to detect the end of the faults with some delay. There are 2 false positives from the detector, which correspond to high UserID values in the dataset. These two locations are marked as suspicious so in this case the false positive would still be worth investigating even if it is deemed not dangerous.
 
\begin{figure}[H]
    %%\centering
    \input{3_beth_sim/outlier_result_evil_userId.pgf}
    \caption{BETH Dangerous Outliers [Red Line = Anomaly]}
    \label{fig:beth_evil_outliers}
\end{figure}

\subsection{Summary}